# 1. 서버 사이드 렌더링의 이해

서버 사이드 렌더링은 UI를 다른 서버에서 렌더링하는 것을 의미합니다. 리액트 프로젝트는 기본적으로 클라이언트 사이드 렌더링(CSR)을 하고 있습니다. 클라이언트 사이드 렌더링은 UI렌더링을 브라우저에서 모두 처리하는 것이죠. 즉, 자바스크립트를 실행해야 우리가 만든 화면이 사용자에게 보입니다.

서버 사이드 렌더링을 구현하면 사용자가 웹 서비스에 방문했을 때 서버 쪽에서 초기 렌더링을 대신해 줍니다. 그리고 사용자가 html을 전달받을 때 그 내부에 렌더링된 결과물이 보입니다.

## 1.1 서버 사이드 렌더링의 장점

서버 사이드 렌더링을 하면 검색 엔진이 우리가 만든 웹 어플리케이션의 페이지를 원활하게 수집할 수 있습니다. 리액트로 만든 SPA(Single Page Aplication)는 검색 엔진 크롤러 봇처럼 자바스크립트가 실행되지 않는 환경에서는 페이지가 제대로 나타나지 않습니다. 따라서 <b>서버에서 클라이언트 대신 렌더링을 해 주면 검색 엔진이 페이지의 내용을 제대로 수집해 갈 수 있습니다.</b>

또한 서버 사이드 렌더링을 통해 <b>초기 렌더링 성능을 개선할 수 있습니다.</b> 예를 들어 서버 사이드 렌더링이 구현되지 않은 웹 페이지에 사용자가 방문하면, 자바스크립트가 로딩되고 실행될 때까지 사용자는 비어 있는 페이지를 보며 대기해야 합니다. 여기에 API까지 호출해야 한다면 사용자의 대기 시간이 더더욱 길어집니다. 반면 서버 사이드 렌더링을 구현한 웹 페이지라면 자바스크립트 파일 다운로드가 완료되지 않은 시점에서도 html 상에 사용자가 볼 수 있는 콘텐츠가 있기 때문에 대기 시간이 최소화되고, 이로 인해 사용자 경험도 향상됩니다.

## 1.2 서버 사이드 렌더링의 단점

원래 브라우저가 해야 할 일을 서버가 대신 처리하는 것이므로 <b>서버 리소스가 사용된다</b>는 단점이 있습니다. 갑자기 <b>수많은 사용자가 동시에 웹 페이지에 접속하면 서버에 과부하가 발생할 수 있습니다.</b> 따라서 사용자가 많은 서비스라면 <b>캐싱</b>과 <b>로드 밸런싱</b>을 통해 성능을 최적화해 주어야 합니다.

# 2. 프로젝트 준비하기

서버 사이드 렌더링을 구현하려면 웹팩 설정을 커스터마이징해 주어야 합니다. CRA(Create-react-app)로 만든 프로젝트에서는 웹팩 관련 설정이 기본적으로 무두 숨겨져 있으니 yarn eject 명령어를 실행하여 밖으로 꺼내야 합니다.

```
yarn eject
```

eject시, 📁 config 폴더가 생성됩니다.

## 2.1 서버 사이드 렌더링용 엔트리 만들기

<b>엔트리(entry)</b>는 웹팩에서 프로젝트를 불러올 때 가장 먼저 불러오는 파일입니다. 일반적으로 리액트의 index.js를 엔트리 파일로 사용합니다. 이 파일부터 시작하여 내부에 필요한 다른 컴포넌트와 모듈을 불러오고 있습니다.

서버 사이드 렌더링을 할 때는 서버를 위한 엔트리 파일을 따로 생성해야 합니다. src/index.server.js 라는 파일을 이 서버용 엔트리 파일로 사용하겠습니다.

- 📁 config/paths.js 파일에서 웹팩 환경 설정을 작성합니다.
  > 어디로 저장하고, 어떤 파일을 렌더링할 것인가?
- 📁 config/webpack.config.server.js 웹팩 환경 설정 파일을 작성합니다.
  > 빌드할 때 어떤 파일에서 시작해 파일들을 불러오는지, 어디에 결과물을 저장할지
- 로더를 설정합니다. 웹팩의 로더는 파일을 불러올 때 확장자에 맞게 필요한 처리를 해 줍니다.
  > 자바스크립트는 babel을 사용하여 트랜스파일링을 해 주고, CSS는 모든 CSS코드를 결합해 주고, 이미지 파일은 파일을 다른 경로에 따로 저장하고 그 파일에 대한 경로를 자바스크립트에서 참조할 수 있게 해 줍니다.
- 코드에서 node_modules 내부의 라이브러리를 불러올 수 있게 설정합니다. 📁 config/webpack.config.server.js
  > 이렇게 했을 때 react, react-dom/server 같은 라이브러리를 import 구문으로 불러오면 node_modules에서 찾아 사용합니다. 라이브러리를 불러오면 빌드할 때 결과물 파일 안에 해당 라이브러리 관련 코드가 함께 번들링됩니다.
  > 브라우저에서 사용할 때는 결과물 파일에 리액트 라이브러리와 우리의 애플리케이션에 관한 코드가 공존해야 합니다.

### 🌟slice 함수🌟

https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice

const animals = ['ant', 'bison', 'camel', 'duck', 'elephant'];

console.log(animals.slice(0,-1));
// expected output: Array ["ant", "bison", "camel", "duck"]

console.log(animals.slice(2,-1));
// expected output: Array ["camel", "duck"]

console.log(animals.slice(2, 4));
// expected output: Array ["camel", "duck"]

console.log(animals.slice(1, 5));
// expected output: Array ["bison", "camel", "duck", "elephant"]
